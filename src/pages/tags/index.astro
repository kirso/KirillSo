---
import { getAllPosts, getUniqueTagsWithCount } from "@/data/post";
import PageLayout from "@/layouts/Base.astro";
import Schema from "@/components/Schema.astro";

const allPosts = await getAllPosts();
const allTags = getUniqueTagsWithCount(allPosts);
const totalPosts = allPosts.length;

const meta = {
	description:
		"A full index of topics and themes I've written about on life, technology, business, learning, thinking, and more",
	title: "Tags",
};
---

<PageLayout meta={meta}>
  <Schema type="breadcrumb" breadcrumbs={[
    { name: "Home", url: "/" },
    { name: "Tags", url: "/tags/" }
  ]} />
  <header class="mb-12">
    <h1 class="page-title">Tags</h1>
    <p class="mt-2 text-text-secondary">{allTags.length} topics across {totalPosts} posts</p>
  </header>

  <section>
    <div class="section-rule mb-6"><span>All Topics</span></div>
    <ul class="space-y-1">
      {
        allTags.map(([tag, count]) => (
          <li class="post-row">
            <a class="post-title link" href={`/tags/${tag}/`}>
              {tag}
            </a>
            <span class="post-leader"></span>
            <span class="post-date mono">{count} {count === 1 ? 'post' : 'posts'}</span>
          </li>
        ))
      }
    </ul>
  </section>

  <nav class="mt-12">
    <a class="arrow-link" href="/posts/">
      View all posts <span aria-hidden="true">â†’</span>
    </a>
  </nav>
</PageLayout>
